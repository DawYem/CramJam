<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CramJam</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Navigation Menu Styles */
        .nav-menu {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            background: rgba(28, 28, 28, 0.9);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            border: 1px solid rgba(147, 112, 219, 0.3);
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover {
            background: rgba(147, 112, 219, 0.8);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(147, 112, 219, 0.3);
        }

        .nav-btn.active {
            background: #9370DB;
            border-color: #9370DB;
        }

        .nav-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
                gap: 5px;
            }
            
            .nav-btn {
                padding: 8px 12px;
                font-size: 14px;
            }
        }

        .app-container {
            width: 100vw;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .main-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: auto;
            width: 100vw;
            box-sizing: border-box;
            padding: 20px 200px 20px 20px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Custom Scrollbar Styles */
        html {
            height: 100%;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        body {
            min-height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }

        /* Main scrollbar only */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(28, 28, 28, 0.5);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #9370DB, #b19cd9);
            border-radius: 6px;
            border: 2px solid rgba(28, 28, 28, 0.3);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #b19cd9, #d8c7f0);
            box-shadow: 0 0 10px rgba(147, 112, 219, 0.4);
        }

        /* Welcome Page Styles */

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(28, 28, 28, 0.9);
            border-radius: 12px;
            margin-bottom: 10px;
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .player-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-link {
            padding: 8px 15px;
            border-radius: 8px;
            background: rgba(147, 112, 219, 0.1);
            color: #fff;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid rgba(147, 112, 219, 0.2);
            font-size: 0.9rem;
        }

        .nav-link:hover {
            background: rgba(147, 112, 219, 0.2);
            transform: translateY(-2px);
        }

        .section-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .timer-section {
            background: rgba(28, 28, 28, 0.9);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .timer-display {
            font-size: 2.5rem;
            text-align: center;
            margin: 10px 0;
        }

        .control-group {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 8px 15px;
            border-radius: 8px;
            background: rgba(147, 112, 219, 0.1);
            color: #fff;
            border: 1px solid rgba(147, 112, 219, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn:hover {
            background: rgba(147, 112, 219, 0.2);
            transform: translateY(-2px);
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input {
            flex: 1;
            padding: 8px 15px;
            border-radius: 8px;
            background: rgba(28, 28, 28, 0.9);
            border: 1px solid rgba(147, 112, 219, 0.2);
            color: #fff;
            font-size: 0.9rem;
        }

        .player {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            background: rgba(28, 28, 28, 0.9);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .controls {
            position: sticky;
            bottom: 0;
            background: rgba(28, 28, 28, 0.95);
            padding: 12px;
            border-radius: 12px;
            border: 1px solid rgba(147, 112, 219, 0.3);
            z-index: 100;
        }

        #volumeControl {
            width: 120px;
        }

        .section-card {
            background: rgba(28, 28, 28, 0.9);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .section-header {
            margin-bottom: 10px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title h2, .section-title h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .section-icon, .timer-icon, .control-icon, .preset-icon {
            font-size: 1.2rem;
        }

        .now-playing {
            background: rgba(28, 28, 28, 0.9);
            padding: 12px;
            border-radius: 12px;
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .now-playing p {
            margin: 0;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .groupme-connect {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        #chatMessages {
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(28, 28, 28, 0.5);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        #chatMessages::-webkit-scrollbar {
            width: 5px;
        }

        #chatMessages::-webkit-scrollbar-thumb {
            background: rgba(147, 112, 219, 0.3);
            border-radius: 5px;
        }

        .chat-container {
            background: rgba(28, 28, 28, 0.5);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            height: 300px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding-right: 5px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .chat-messages::-webkit-scrollbar {
            width: 5px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: rgba(147, 112, 219, 0.3);
            border-radius: 5px;
        }

        .chat-message {
            padding: 8px 12px;
            border-radius: 8px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .chat-message.user {
            align-self: flex-end;
            background: rgba(147, 112, 219, 0.2);
            border: 1px solid rgba(147, 112, 219, 0.3);
        }

        .chat-message.other {
            align-self: flex-start;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-message .sender {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 4px;
        }

        .chat-message .content {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .chat-message .timestamp {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.4);
            text-align: right;
            margin-top: 4px;
        }

        .chat-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input-group .input {
            flex: 1;
        }

        .chat-input-group .btn {
            white-space: nowrap;
        }

        .encouragement-container {
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(28, 28, 28, 0.5);
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .encouragement-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .encouragement-text {
            flex: 1;
        }

        .encouragement-btn {
            background: rgba(147, 112, 219, 0.2);
            border: 1px solid rgba(147, 112, 219, 0.3);
            border-radius: 8px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #b19cd9;
            transition: all 0.3s ease;
        }

        .encouragement-btn:hover {
            background: rgba(147, 112, 219, 0.3);
            transform: rotate(180deg);
        }

        .encouragement-btn:active {
            transform: scale(0.95) rotate(180deg);
        }

        .encouragement-btn-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .tooltip {
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            margin-right: 12px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            margin-top: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: transparent transparent transparent rgba(0, 0, 0, 0.8);
        }

        .encouragement-btn:hover + .tooltip,
        .encouragement-btn:focus + .tooltip {
            opacity: 1;
            visibility: visible;
            right: calc(100% + 5px);
        }

        .encouragement-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            line-height: 1.5;
            padding: 10px;
        }

        /* Welcome Page Styles */
        .welcome-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }

        .welcome-header {
            text-align: center;
            margin-bottom: 50px;
            padding: 50px 40px;
            background: linear-gradient(135deg, rgba(28, 28, 28, 0.95), rgba(147, 112, 219, 0.1));
            border-radius: 25px;
            border: 1px solid rgba(147, 112, 219, 0.4);
            position: relative;
            overflow: hidden;
        }

        .welcome-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(147, 112, 219, 0.1), transparent);
            z-index: 1;
        }

        .welcome-header .section-title {
            justify-content: center;
            gap: 20px;
            position: relative;
            z-index: 2;
        }

        .welcome-header .logo {
            font-size: 4rem;
            filter: drop-shadow(0 0 15px rgba(147, 112, 219, 0.5));
        }

        .welcome-header h1 {
            font-size: 3.5rem;
            margin: 0;
            background: linear-gradient(135deg, #9370DB, #b19cd9, #d8c7f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 2;
            font-weight: 700;
            text-shadow: 0 0 30px rgba(147, 112, 219, 0.3);
        }
        

        .mission-content {
            display: flex;
            flex-direction: column;
            gap: 50px;
        }

        .mission-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
            padding: 0 20px;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .mission-card {
            background: linear-gradient(135deg, #9d5bb8, #7f4da3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: white;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
            min-height: 200px;
            width: 100%;
            margin: 0;
            position: relative;
            overflow: hidden;
        }

        .mission-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent, rgba(147, 112, 219, 0.05));
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
        }

        .mission-card:hover::before {
            opacity: 1;
        }

        .mission-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(147, 112, 219, 0.7);
            box-shadow: 0 15px 40px rgba(147, 112, 219, 0.3);
        }

        .mission-icon {
            font-size: 4rem;
            display: block;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 0 10px rgba(147, 112, 219, 0.3));
        }

        .mission-card h2 {
            color: #9370DB;
            font-size: 1.6rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            font-weight: 600;
        }

        .mission-card p {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.8;
            font-size: 1.05rem;
            position: relative;
            z-index: 2;
            margin: 0;
        }

        .get-started-section {
            text-align: center;
            padding: 50px 40px;
            background: linear-gradient(135deg, rgba(28, 28, 28, 0.95), rgba(147, 112, 219, 0.1));
            border-radius: 25px;
            border: 1px solid rgba(147, 112, 219, 0.4);
            position: relative;
            overflow: hidden;
        }

        .get-started-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at bottom, rgba(147, 112, 219, 0.1), transparent);
            z-index: 1;
        }

        .get-started-section h2 {
            color: #9370DB;
            font-size: 2.2rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            font-weight: 600;
        }

        .get-started-section p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            margin-bottom: 35px;
            position: relative;
            z-index: 2;
        }

        .quick-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            position: relative;
            z-index: 2;
        }
        

        .quick-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 35px 30px;
            background: linear-gradient(135deg, rgba(147, 112, 219, 0.15), rgba(147, 112, 219, 0.05));
            border: 1px solid rgba(147, 112, 219, 0.4);
            border-radius: 20px;
            text-decoration: none;
            color: #fff;
            transition: all 0.4s ease;
            min-width: 180px;
            position: relative;
            overflow: hidden;
        }

        .quick-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(147, 112, 219, 0.2), transparent);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 1;
        }

        .quick-link:hover::before {
            opacity: 1;
        }

        .quick-link:hover {
            background: linear-gradient(135deg, rgba(147, 112, 219, 0.25), rgba(147, 112, 219, 0.1));
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(147, 112, 219, 0.4);
            border-color: rgba(147, 112, 219, 0.7);
        }

        .link-icon {
            font-size: 2.5rem;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 0 8px rgba(147, 112, 219, 0.3));
        }

        .link-text {
            font-size: 1.1rem;
            font-weight: 600;
            position: relative;
            z-index: 2;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .welcome-header h1 {
                font-size: 2rem;
            }
            
            .mission-section {
                grid-template-columns: 1fr;
                padding: 0 20px;
            }
            
            .mission-card {
                max-width: 100%;
            }
            
            .quick-links {
                flex-direction: column;
                align-items: center;
            }
            
            .app-container {
                padding: 10px;
            }
        }

        @media (min-width: 769px) and (max-width: 1200px) {
            .mission-section {
                grid-template-columns: repeat(2, 1fr);
                gap: 25px;
            }
        }

        @media (min-width: 1201px) {
            .mission-section {
                grid-template-columns: repeat(3, 1fr);
                gap: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="background-shapes" id="backgroundShapes"></div>
    
    <!-- Navigation Menu -->
    <nav class="nav-menu">
        <a href="index.html" class="nav-btn active">
            <span class="nav-icon">üè†</span>Home
        </a>
        <a href="music-player.html" class="nav-btn">
            <span class="nav-icon">üéµ</span>Music Player
        </a>
        <a href="todo-list.html" class="nav-btn">
            <span class="nav-icon">üìù</span>Todo List
        </a>
        <a href="contact-support.html" class="nav-btn">
            <span class="nav-icon">üí¨</span>Support
        </a>
    </nav>
    
    <div class="logout-toast" id="logoutToast">Logging out...</div>
    
    <div class="app-container">
        <div class="main-section">
            <div class="welcome-container">
                <div class="welcome-header">
                    <div class="section-title">
                        <span class="logo">üéµ</span>
                        <h1>Welcome to CramJam</h1>
                    </div>
                </div>

                <div class="mission-content">
                    <div class="mission-section">
                        <div class="mission-card">
                            <span class="mission-icon">üéØ</span>
                            <h2>Our Mission</h2>
                            <p>CramJam is your ultimate study companion, designed to maximize your productivity and learning efficiency. We combine proven study techniques with modern technology to help you achieve your academic goals.</p>
                        </div>

                        <div class="mission-card">
                            <span class="mission-icon">‚ö°</span>
                            <h2>Boost Your Focus</h2>
                            <p>Harness the power of the Pomodoro Technique with our integrated timer system. Stay focused during study sessions and take strategic breaks to maintain peak mental performance.</p>
                        </div>

                        <div class="mission-card">
                            <span class="mission-icon">üéµ</span>
                            <h2>Perfect Study Environment</h2>
                            <p>Create your ideal study atmosphere with our music player featuring focus-enhancing playlists, ambient sounds, and customizable audio environments tailored for deep concentration.</p>
                        </div>

                        <div class="mission-card">
                            <span class="mission-icon">‚úÖ</span>
                            <h2>Organize Your Success</h2>
                            <p>Track your progress with our intuitive task management system. Set goals, monitor completion rates, and celebrate your achievements as you advance toward academic excellence.</p>
                        </div>

                        <div class="mission-card">
                            <span class="mission-icon">üí¨</span>
                            <h2>We're Here to Help</h2>
                            <p>Need assistance? Our support team is ready to help you make the most of CramJam. Get tips, troubleshoot issues, and connect with fellow learners in our community.</p>
                        </div>
                    </div>

                    <div class="get-started-section">
                        <h2>Ready to Transform Your Study Sessions?</h2>
                        <p>Choose your tool and start your journey to academic success:</p>
                        <div class="quick-links">
                            <a href="music-player.html" class="quick-link">
                                <span class="link-icon">üéµ</span>
                                <span class="link-text">Start Music Player</span>
                            </a>
                            <a href="todo-list.html" class="quick-link">
                                <span class="link-icon">üìù</span>
                                <span class="link-text">Manage Tasks</span>
                            </a>
                            <a href="contact-support.html" class="quick-link">
                                <span class="link-icon">üí¨</span>
                                <span class="link-text">Get Support</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Background Animation Script -->
    <script type="module">
        // Import modules
        import { initTimer } from './js/timer.js';
        import { initChat } from './js/chat.js';
        import { 
            addYouTubeTrack, 
            loadYouTubeAPI,
            initYouTubePlayer
        } from './js/youtube.js';
        import { 
            playTrack, 
            togglePlayPause, 
            playNext, 
            playPrevious, 
            removeTrack, 
            loadPlaylist, 
            createWaveBars,
            updateCurrentTrackDisplay,
            savePlaylist,
            updatePlaylistUI
        } from './js/player.js';
        import { 
            initEncouragement,
            updateEncouragementMessages,
            showNotification
        } from './js/encouragement.js';
        
        // Make functions available globally
        window.playTrack = playTrack;
        window.togglePlayPause = togglePlayPause;
        window.playNext = playNext;
        window.playPrevious = playPrevious;
        window.removeTrack = removeTrack;
        window.loadPlaylist = loadPlaylist;
        window.savePlaylist = savePlaylist;
        window.updatePlaylistUI = updatePlaylistUI;
        window.showNotification = showNotification;

        // Check if user is logged in
        function checkLogin() {
            // In a real app, you would check authentication status
            // For now, we'll just return true to allow access
            return true;
        }
        
        // Initialize components when DOM is loaded
        document.addEventListener('DOMContentLoaded', async () => {
            if (checkLogin()) {
                try {
                    // Initialize YouTube API and player
                    console.log('Loading YouTube API...');
                    await loadYouTubeAPI();
                    console.log('YouTube API loaded, initializing player...');
                    await initYouTubePlayer();
                    console.log('YouTube player initialized');
                    
                    // Initialize other components
                    console.log('Initializing other components...');
                    initTimer();
                    createBackgroundShapes();
                    loadPlaylist();
                    createWaveBars();
                    initChat();
                    initEncouragement();
                    
                    // Show welcome message
                    console.log('Showing welcome message...');
                    setTimeout(() => {
                        showNotification('Welcome to CramJam! üéµ Start by adding some music or setting a timer.');
                    }, 1000);
                    
                    console.log('Initialization complete');
                } catch (error) {
                    console.error('Initialization error:', error);
                    showNotification('Error initializing application: ' + (error.message || 'Unknown error'));
                    
                    // Show more detailed error for YouTube API issues
                    if (error.message.includes('YouTube API')) {
                        showNotification('Please check your internet connection and refresh the page.');
                    }
                }
            } else {
                // Redirect to login page if not authenticated
                console.log('User not logged in, redirecting to login page...');
                window.location.href = 'login.html';
            }
        });

        // Handle local file uploads
        document.getElementById('localFile').addEventListener('change', (event) => {
            const files = event.target.files;
            if (!files || files.length === 0) return;

            if (!window.playlist) {
                window.playlist = [];
            }

            let addedCount = 0;
            Array.from(files).forEach((file, index) => {
                // Only process audio files
                if (!file.type.startsWith('audio/')) return;

                const track = {
                    id: 'local_' + Date.now() + '_' + index,
                    type: 'audio',
                    title: file.name.replace(/\.[^/.]+$/, ''), // Remove file extension
                    url: URL.createObjectURL(file)
                };

                window.playlist.push(track);
                addedCount++;
            });

            if (addedCount > 0) {
                // Save playlist and update UI
                savePlaylist();
                updatePlaylistUI();

                // Play the first track if it's the only one
                if (window.playlist.length === addedCount) {
                    playTrack(0);
                }
                
                // Show success message
                showNotification(`Added ${addedCount} file(s) to playlist`);
            } else {
                showNotification('No audio files were added. Please select valid audio files.');
            }

            // Reset file input
            event.target.value = '';
        });
        
        // Handle YouTube URL form submission
        const youtubeForm = document.querySelector('form');
        if (youtubeForm) {
            youtubeForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const urlInput = document.getElementById('youtubeUrl');
                const url = urlInput?.value.trim();
                
                if (url) {
                    addYouTubeTrack(url)
                        .then(() => {
                            urlInput.value = '';
                        })
                        .catch(error => {
                            console.error('Error adding YouTube track:', error);
                            showNotification('Error adding YouTube video: ' + (error.message || 'Unknown error'));
                        });
                }
            });
        }

        // Update the addYouTubeTrack function if it exists
        if (window.addYouTubeTrack) {
            window.addYouTubeTrack = async function() {
                const urlInput = document.getElementById('youtubeUrl');
                const url = urlInput?.value.trim();
                
                if (!url) {
                    alert('Please enter a YouTube URL');
                    return;
                }

                try {
                    // Ensure YouTube API is loaded
                    await loadYouTubeAPI();
                    // Initialize player if needed
                    if (!window.youtubePlayer) {
                        await initYouTubePlayer();
                    }
                    // Add track to playlist
                    await addYouTubeTrack(url);
                    urlInput.value = '';
                    savePlaylist();
                    // Update playlist encouragement
                    updateEncouragementMessages('playlistEncouragement', 'playlist');
                } catch (error) {
                    console.error('Error adding YouTube video:', error);
                    alert('Error adding YouTube video: ' + (error.message || 'Unknown error'));
                }
            };
        }

        // These are already defined at the top of the file, no need to redefine them
        // window.playTrack = playTrack;
        // window.togglePlayPause = togglePlayPause;
        // window.playNext = playNext;
        // window.playPrevious = playPrevious;
        // window.removeTrack = removeTrack;
        
        // GroupMe functions - only define if they don't exist
        if (!window.connectGroupMe) {
            window.connectGroupMe = function() {
                alert('GroupMe integration not implemented yet');
            };
        }
        
        if (!window.sendMessage) {
            window.sendMessage = function() {
                alert('Send message function not implemented yet');
            };
        }

        if (!window.getNewEncouragement) {
            window.getNewEncouragement = function() {
                updateEncouragementMessages('encouragementMessage', 'timer');
            };
        }

        // Add logout function if it doesn't exist
        if (!window.logout) {
            window.logout = function() {
                localStorage.removeItem('sessionToken');
                window.location.href = 'login.html';
            };
        }

        // Check if user is logged in - use the one defined at the top of the file
        // function checkLogin() {
        //     return true; // Already defined at the top
        // }

        // Create background shapes
        function createBackgroundShapes() {
            const container = document.getElementById('backgroundShapes');
            const musicIcons = ['üéµ', 'üé∂', 'üéº', 'üéπ', 'üé∏', 'üé∑', 'üé∫', 'üéª', 'ü•Å'];
            
            // Create floating circles
            for (let i = 0; i < 10; i++) {
                const shape = document.createElement('div');
                shape.className = 'shape';
                shape.style.width = `${Math.random() * 200 + 100}px`;
                shape.style.height = shape.style.width;
                shape.style.left = `${Math.random() * 100}%`;
                shape.style.top = `${Math.random() * 100}%`;
                shape.style.animationDelay = `${Math.random() * 15}s`;
                container.appendChild(shape);
            }

            // Create floating music icons
            for (let i = 0; i < 20; i++) {
                const icon = document.createElement('div');
                icon.className = 'music-icon';
                icon.textContent = musicIcons[Math.floor(Math.random() * musicIcons.length)];
                icon.style.left = `${Math.random() * 100}%`;
                icon.style.top = `${Math.random() * 100}%`;
                icon.style.animationDelay = `${Math.random() * 20}s`;
                icon.style.fontSize = `${Math.random() * 20 + 16}px`;
                container.appendChild(icon);
            }
        }

        const encouragementQuotes = [
            "You're capable of more than you know! Keep pushing forward! üí™",
            "Every step you take brings you closer to your goals! üöÄ",
            "Your hard work today will pay off tomorrow! Keep going! ‚≠ê",
            "You're stronger than you think! Don't give up! üåü",
            "Success is built one study session at a time! You've got this! üéØ",
            "The only way to fail is to stop trying! Keep moving forward! üí´",
            "Your dedication is inspiring! Keep up the great work! üåà",
            "Every minute you study is an investment in your future! üìö",
            "You're making progress, even when it doesn't feel like it! üéì",
            "Stay focused, stay determined, and you'll achieve greatness! üèÜ",
            "Your potential is limitless! Keep reaching for the stars! ‚ú®",
            "Remember why you started! Your goals are worth it! üéØ",
            "You're building a brighter future with every study session! üåü",
            "The best way to predict your future is to create it! Keep going! üöÄ",
            "Your persistence is your power! Don't stop now! üí™",
            "Believe in yourself and all that you are! You're amazing! üåü",
            "Small progress is still progress! Keep moving forward! üê¢",
            "Your effort today is your success tomorrow! Keep pushing! üí™",
            "You're not just studying, you're building your future! üèóÔ∏è",
            "Every challenge you face makes you stronger! Keep going! üí™",
            "Your focus and determination will lead to success! üéØ",
            "The more you learn, the more you grow! Keep it up! üå±",
            "You're creating your own success story! Write it well! üìñ",
            "Your dedication to learning is truly inspiring! üåü",
            "Every question you answer brings you closer to mastery! üéì",
            "You're not just studying, you're investing in yourself! üíé",
            "Your commitment to learning is your superpower! ü¶∏",
            "Keep going, you're doing better than you think! üåü",
            "Your study time is your path to success! üõ£Ô∏è",
            "You're building knowledge that will last a lifetime! üè∞",
            "Each study session is a step toward your dreams! üå†",
            "Your brain is like a muscle - the more you use it, the stronger it gets! üí™",
            "The road to success is paved with consistent effort! Keep walking! üõ£Ô∏è",
            "Your future self will thank you for studying today! üôè",
            "Learning is a journey, and you're making great progress! üó∫Ô∏è",
            "Your determination is your greatest asset! Keep it up! üíé",
            "Every concept you master is a victory! Celebrate your progress! üéâ",
            "You're not just memorizing facts, you're expanding your mind! üß†",
            "Your study habits today shape your success tomorrow! üìà",
            "The more you challenge yourself, the more you grow! üå±",
            "Your commitment to learning is your ticket to success! üéüÔ∏è",
            "Every study session is an opportunity to grow! üå±",
            "You're not just studying, you're preparing for greatness! üëë",
            "Your focus today creates your success tomorrow! üéØ",
            "The more you learn, the more doors open for you! üö™",
            "Your dedication to education is your path to freedom! üïäÔ∏è",
            "Every minute of study is a minute closer to your dreams! ‚è≥",
            "You're not just learning, you're transforming your future! ü¶ã",
            "Your study efforts today are your success story tomorrow! üìñ",
            "The more you know, the more you can achieve! üéØ"
        ];

        // Function to update encouragement message
        function updateEncouragementMessage() {
            const randomQuote = encouragementQuotes[Math.floor(Math.random() * encouragementQuotes.length)];
            const messageElement = document.getElementById('encouragementMessage');
            if (messageElement) {
                messageElement.textContent = randomQuote;
                messageElement.style.animation = 'fadeIn 0.5s ease-in-out';
                setTimeout(() => {
                    messageElement.style.animation = '';
                }, 500);
            }
        }

        // Update encouragement message when button is clicked
        const refreshBtn = document.getElementById('refreshEncouragement');
        if (refreshBtn) {
            refreshBtn.addEventListener('click', (e) => {
                e.preventDefault();
                updateEncouragementMessage();
            });
        }

        // Update encouragement message periodically
        setInterval(updateEncouragementMessage, 30000); // Change message every 30 seconds
